{
  "hash": "065ee3c19d9371eb174bc8c21f91cfc8",
  "result": {
    "markdown": "---\nauthor: \"Luiz Favaro\"\neditor: visual\nformat:\n  html:\n    embed-resources: true\n    self-contained-math: true\n---\n\n\n# Exemplo Vestibular {.unnumbered}\n\n\n**Curso:** MBA DSA USP ESALQ\n\n**Fonte:** Fávero e Belfiore, MANUAL DE ANÁLISE DE DADOS, Capítulo 09\n\n**Prof.:** Wilson Tarantin Jr.\n\n## Preparação\n\nInstalação e carregamento dos pacotes utilizados\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-1_67ca981233763949c0303e0d3ffc5aec'}\n\n```{.r .cell-code}\npacotes <- c(\"plotly\", #plataforma gráfica\n             \"tidyverse\", #carregar outros pacotes do R\n             \"ggrepel\", #geoms de texto e rótulo para 'ggplot2' que ajudam a\n                        #evitar sobreposição de textos\n             \"knitr\", \"kableExtra\", #formatação de tabelas\n             \"reshape2\", #função 'melt'\n             \"misc3d\", #gráficos 3D\n             \"plot3D\", #gráficos 3D\n             \"cluster\", #função 'agnes' para elaboração de clusters hierárquicos\n             \"factoextra\", #função 'fviz_dend' para construção de dendrogramas\n             \"ade4\") #função 'ade4' para matriz de distâncias em var. binárias\n\nif(sum(as.numeric(!pacotes %in% installed.packages())) != 0){\n  instalador <- pacotes[!pacotes %in% installed.packages()]\n  for(i in 1:length(instalador)) {\n    install.packages(instalador, dependencies = T)\n    break()}\n  sapply(pacotes, require, character = T) \n} else {\n  sapply(pacotes, require, character = T) \n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: plotly\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'plotly'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: tidyverse\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in system(\"timedatectl\", intern = TRUE): running command 'timedatectl'\nhad status 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n✔ purrr   0.3.4      \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks plotly::filter(), stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nLoading required package: ggrepel\n\nLoading required package: knitr\n\nLoading required package: kableExtra\n\n\nAttaching package: 'kableExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\n\nLoading required package: reshape2\n\n\nAttaching package: 'reshape2'\n\n\nThe following object is masked from 'package:tidyr':\n\n    smiths\n\n\nLoading required package: misc3d\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: no DISPLAY variable so Tk is not available\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: plot3D\nLoading required package: cluster\nLoading required package: factoextra\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\nLoading required package: ade4\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n    plotly  tidyverse    ggrepel      knitr kableExtra   reshape2     misc3d \n      TRUE       TRUE       TRUE       TRUE       TRUE       TRUE       TRUE \n    plot3D    cluster factoextra       ade4 \n      TRUE       TRUE       TRUE       TRUE \n```\n:::\n:::\n\n\n> Se der o erro: \"Error in kable_styling\", instale:\n>\n> `sudo apt -y install libfontconfig1-dev` e `sudo apt install cmake`\n\n### Análise Exploratória\n\n#### Carrega a base\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-2_e58ac033cf67abcc40d559a875564e11'}\n\n```{.r .cell-code}\nload(file = \"./data/mod1_01_01_vestibular.RData\")\n```\n:::\n\n\n#### Visualiza dados\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-3_22dca78d36a78337f7e5599017877cb9'}\n\n```{.r .cell-code}\nVestibular %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\", \n                full_width = FALSE,\n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> estudante </th>\n   <th style=\"text-align:right;\"> matematica </th>\n   <th style=\"text-align:right;\"> fisica </th>\n   <th style=\"text-align:right;\"> quimica </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gabriela </td>\n   <td style=\"text-align:right;\"> 3.7 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n   <td style=\"text-align:right;\"> 9.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luiz Felipe </td>\n   <td style=\"text-align:right;\"> 7.8 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Patricia </td>\n   <td style=\"text-align:right;\"> 8.9 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ovidio </td>\n   <td style=\"text-align:right;\"> 7.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 9.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Leonor </td>\n   <td style=\"text-align:right;\"> 3.4 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nOs dados são compostos por 5 alunos e suas médias em 3 matérias: matemática, física e química.\n\nRenomeia linhas\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-4_28fe9008f74e769ca6942ca6ad779686'}\n\n```{.r .cell-code}\nrownames(Vestibular) <- Vestibular$estudante\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Setting row names on a tibble is deprecated.\n```\n:::\n:::\n\n\n#### Visualiza dados em 3D\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-5_8adb7fa355fba8de90d4ab11121f8873'}\n\n```{.r .cell-code}\nscatter3D(x=Vestibular$fisica,\n          y=Vestibular$matematica,\n          z=Vestibular$quimica,\n          phi = 0, bty = \"g\", pch = 20, cex = 2,\n          xlab = \"Fisica\",\n          ylab = \"Matematica\",\n          zlab = \"Quimica\",\n          main = \"Vestibular\",\n          clab = \"Nota de Quimica\")>\n  text3D(x=Vestibular$fisica,\n         y=Vestibular$matematica,\n         z=Vestibular$quimica,\n         labels = rownames(Vestibular),\n         add = TRUE, cex = 1)\n```\n\n::: {.cell-output-display}\n![](mod1_01_01_analise_de_cluster_vestibular_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]  [,2]  [,3]  [,4]\n[1,] FALSE FALSE FALSE FALSE\n[2,] FALSE FALSE FALSE FALSE\n[3,] FALSE FALSE FALSE FALSE\n[4,] FALSE FALSE FALSE FALSE\n```\n:::\n:::\n\n\nÉ possível visualizar os *clusters* formados: a Gabriela e o Ovídio são mais próximos, assim como a Patrícia e o Luiz Felipe. A Leonor está entre os dois grupos.\n\n#### Estatística descritiva\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-6_1725313b55100c503a2d18b26cc044ae'}\n\n```{.r .cell-code}\nsummary(Vestibular)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  estudante           matematica       fisica        quimica    \n Length:5           Min.   :3.40   Min.   :1.00   Min.   :1.50  \n Class :character   1st Qu.:3.70   1st Qu.:1.00   1st Qu.:2.70  \n Mode  :character   Median :7.00   Median :2.00   Median :5.00  \n                    Mean   :6.16   Mean   :2.94   Mean   :5.46  \n                    3rd Qu.:7.80   3rd Qu.:2.70   3rd Qu.:9.00  \n                    Max.   :8.90   Max.   :8.00   Max.   :9.10  \n```\n:::\n:::\n\n\nA média e a mediana das notas de matemática são as maiores, enquanto as da física são as menores. 75% dos alunos tiveram nota de física abaixo de 5, enquanto que em química foram 50% e em matemática 50% tiveram nota a partir de 7.\n\n### Padronização\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-7_f2eeb26e6e6a397d2265e3c05e560060'}\n\n```{.r .cell-code}\n# Se for necessário padronizar, é possível utilizar a função scale()\nvest_padronizado <- as.data.frame(scale(Vestibular[,2:4]))\nrownames(vest_padronizado) <- Vestibular$estudante\nvest_padronizado\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            matematica      fisica    quimica\nGabriela    -0.9925328 -0.08223228  1.0369151\nLuiz Felipe  0.6616886  1.73373093 -1.1280724\nPatricia     1.1055039 -0.66471107 -0.7862322\nOvidio       0.3389136 -0.66471107  1.0084283\nLeonor      -1.1135733 -0.32207650 -0.1310387\n```\n:::\n:::\n\n\nCom a padronização, todas as matérias ficaram com média zero e desvio padrão igual a 1:\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-8_46cb40ac9eb748d13062c47b1a2cd594'}\n\n```{.r .cell-code}\nsummary(vest_padronizado)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   matematica          fisica            quimica       \n Min.   :-1.1136   Min.   :-0.66471   Min.   :-1.1281  \n 1st Qu.:-0.9925   1st Qu.:-0.66471   1st Qu.:-0.7862  \n Median : 0.3389   Median :-0.32208   Median :-0.1310  \n Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  \n 3rd Qu.: 0.6617   3rd Qu.:-0.08223   3rd Qu.: 1.0084  \n Max.   : 1.1055   Max.   : 1.73373   Max.   : 1.0369  \n```\n:::\n:::\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-9_586e1a2ba2da57eca2db0dd8cf52ac8f'}\n\n```{.r .cell-code}\nsapply(vest_padronizado, sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmatematica     fisica    quimica \n         1          1          1 \n```\n:::\n:::\n\n\n### Boxplot\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-10_6011cdc6fedd619368fe331cad4fc5ec'}\n\n```{.r .cell-code}\nggplotly(\n  Vestibular %>%\n    melt() %>%\n    ggplot(aes(label = estudante)) +\n    geom_boxplot(aes(x = variable, y = value, fill = variable)) +\n    geom_point(aes(x = variable, y = value), alpha = 0.5) +\n    labs(x = \"Variável\",\n         y = \"Nota\") +\n    scale_fill_manual(\"Legenda:\",\n                      values = c(\"orange\", \"purple\", \"bisque4\")) +\n    theme_bw()\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing estudante as id variables\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attributes are not identical across measure variables; they will be\ndropped\n```\n:::\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-685e3019040d60652ffb\" style=\"width:100%;height:464px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-685e3019040d60652ffb\">{\"x\":{\"data\":[{\"x\":[1,1,1,1,1],\"y\":[3.70000004768372,7.80000019073486,8.89999961853027,7,3.40000009536743],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(255,165,0,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.66929133858268},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.88976377952756},\"name\":\"matematica\",\"legendgroup\":\"matematica\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[2,2,2,2,2],\"y\":[2.70000004768372,8,1,1,2],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(160,32,240,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.66929133858268},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.88976377952756},\"name\":\"fisica\",\"legendgroup\":\"fisica\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[3,3,3,3,3],\"y\":[9.10000038146973,1.5,2.70000004768372,9,5],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(139,125,107,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.66929133858268},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.88976377952756},\"name\":\"quimica\",\"legendgroup\":\"quimica\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3],\"y\":[3.70000004768372,7.80000019073486,8.89999961853027,7,3.40000009536743,2.70000004768372,8,1,1,2,9.10000038146973,1.5,2.70000004768372,9,5],\"text\":[\"estudante: Gabriela<br />variable: matematica<br />value: 3.7\",\"estudante: Luiz Felipe<br />variable: matematica<br />value: 7.8\",\"estudante: Patricia<br />variable: matematica<br />value: 8.9\",\"estudante: Ovidio<br />variable: matematica<br />value: 7.0\",\"estudante: Leonor<br />variable: matematica<br />value: 3.4\",\"estudante: Gabriela<br />variable: fisica<br />value: 2.7\",\"estudante: Luiz Felipe<br />variable: fisica<br />value: 8.0\",\"estudante: Patricia<br />variable: fisica<br />value: 1.0\",\"estudante: Ovidio<br />variable: fisica<br />value: 1.0\",\"estudante: Leonor<br />variable: fisica<br />value: 2.0\",\"estudante: Gabriela<br />variable: quimica<br />value: 9.1\",\"estudante: Luiz Felipe<br />variable: quimica<br />value: 1.5\",\"estudante: Patricia<br />variable: quimica<br />value: 2.7\",\"estudante: Ovidio<br />variable: quimica<br />value: 9.0\",\"estudante: Leonor<br />variable: quimica<br />value: 5.0\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,0,1)\",\"opacity\":0.5,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.2283105022831,\"r\":7.30593607305936,\"b\":40.1826484018265,\"l\":43.1050228310502},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,3.6],\"tickmode\":\"array\",\"ticktext\":[\"matematica\",\"fisica\",\"quimica\"],\"tickvals\":[1,2,3],\"categoryorder\":\"array\",\"categoryarray\":[\"matematica\",\"fisica\",\"quimica\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Variável\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.594999980926514,9.50500040054321],\"tickmode\":\"array\",\"ticktext\":[\"2.5\",\"5.0\",\"7.5\"],\"tickvals\":[2.5,5,7.5],\"categoryorder\":\"array\",\"categoryarray\":[\"2.5\",\"5.0\",\"7.5\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Nota\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"title\":{\"text\":\"Legenda:\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"5f6a63770465\":{\"label\":{},\"x\":{},\"y\":{},\"fill\":{},\"type\":\"box\"},\"5f6a24232da3\":{\"label\":{},\"x\":{},\"y\":{}}},\"cur_data\":\"5f6a63770465\",\"visdat\":{\"5f6a63770465\":[\"function (y) \",\"x\"],\"5f6a24232da3\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Aglomeração Hierárquica\n\n### Matriz de dissimilaridades (cofenética)\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-11_70aa348e01ce3afd9531b9a23ea299e9'}\n\n```{.r .cell-code}\nmatriz_D <- Vestibular %>% \n  select(matematica, fisica, quimica) %>% \n  dist(method = \"euclidean\")\nmatriz_D\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          1         2         3         4\n2 10.132127                              \n3  8.419620  7.186793                    \n4  3.713489 10.290287  6.580273          \n5  4.170132  8.222530  6.044832  5.473573\n```\n:::\n:::\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-12_1b0608272fe9ea4cb79b6529946c2a83'}\n\n```{.r .cell-code}\ndata.matrix(matriz_D) %>% \n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\", \n                full_width = FALSE, \n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n   <th style=\"text-align:right;\"> 4 </th>\n   <th style=\"text-align:right;\"> 5 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 10.132127 </td>\n   <td style=\"text-align:right;\"> 8.419620 </td>\n   <td style=\"text-align:right;\"> 3.713489 </td>\n   <td style=\"text-align:right;\"> 4.170132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10.132127 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 7.186793 </td>\n   <td style=\"text-align:right;\"> 10.290287 </td>\n   <td style=\"text-align:right;\"> 8.222530 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8.419620 </td>\n   <td style=\"text-align:right;\"> 7.186793 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 6.580273 </td>\n   <td style=\"text-align:right;\"> 6.044832 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3.713489 </td>\n   <td style=\"text-align:right;\"> 10.290287 </td>\n   <td style=\"text-align:right;\"> 6.580273 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 5.473573 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4.170132 </td>\n   <td style=\"text-align:right;\"> 8.222530 </td>\n   <td style=\"text-align:right;\"> 6.044832 </td>\n   <td style=\"text-align:right;\"> 5.473573 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Argumentos para a função `dist` de cálculo de distância\n\n-   `euclidean`: distância euclidiana\n\n<!-- -->\n\n-   `euclidiana quadrática`: elevar ao quadrado matriz_D (matriz_D\\^2)\n\n-   `maximum`: distância de Chebychev;\n\n-   `manhattan`: distância de Manhattan (ou distância absoluta ou bloco);\n\n-   `canberra`: distância de Canberra;\n\n-   `minkowski`: distância de Minkowski\n\n### Clusterização hierárquica\n\nA partir da matriz cofenética, procede-se com a clusterização hierárquica:\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-13_449515d4c833f9322c1fdce7fc49a066'}\n\n```{.r .cell-code}\ncluster_hier <- agnes(x = matriz_D, method = \"single\")\ncluster_hier\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\t agnes(x = matriz_D, method = \"single\") \nAgglomerative coefficient:  0.3090455 \nOrder of objects:\n[1] 1 4 5 3 2\nHeight (summary):\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  3.713   4.056   5.107   5.279   6.330   7.187 \n\nAvailable components:\n[1] \"order\"  \"height\" \"ac\"     \"merge\"  \"diss\"   \"call\"   \"method\"\n```\n:::\n:::\n\n\n`Method` é o tipo de encadeamento:\n\n-   `complete`: encadeamento completo *(furthest neighbor ou complete linkage)*\n\n-   `single` : encadeamento único *(nearest neighbor ou single linkage)*\n\n-   `average`: encadeamento médio *(between groups ou average linkage)*\n\n### Definição do esquema hierárquico de aglomeração\n\nDistâncias para as combinações em cada estágio\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-14_a063c91a4a3dfe13f6128cf82a739a50'}\n\n```{.r .cell-code}\ncoeficientes <- sort(cluster_hier$height, decreasing = FALSE) \ncoeficientes\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.713489 4.170132 6.044832 7.186793\n```\n:::\n:::\n\n\nTabela com o esquema de aglomeração. Interpretação do output:\n\nAs linhas são os estágios de aglomeração\n\nNas colunas Cluster1 e Cluster2, observa-se como ocorreu a junção\n\n-   Quando for número negativo, indica observação isolada\n\n-   Quando for número positivo, indica cluster formado anteriormente (estágio)\n\n-   Coeficientes: as distâncias para as combinações em cada estágio\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-15_754c5cea6521d862e28436f4b7602e66'}\n\n```{.r .cell-code}\nesquema <- as.data.frame(cbind(cluster_hier$merge, coeficientes))\nnames(esquema) <- c(\"Cluster1\", \"Cluster2\", \"Coeficientes\")\nesquema\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Cluster1 Cluster2 Coeficientes\n1       -1       -4     3.713489\n2        1       -5     4.170132\n3        2       -3     6.044832\n4        3       -2     7.186793\n```\n:::\n:::\n\n\nNúmeros positivos indicam o número do cluster\n\nNúmeros negativos indicam que a observação não entrou em nenhum cluster\n\n### Visualização do esquema hierárquico de aglomeração\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-16_1e5d7f07791c9b101bbc65b8e1f9cd8e'}\n\n```{.r .cell-code}\nesquema %>%\n  kable(row.names = T) %>%\n  kable_styling(bootstrap_options = \"striped\", \n                full_width = FALSE, \n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Cluster1 </th>\n   <th style=\"text-align:right;\"> Cluster2 </th>\n   <th style=\"text-align:right;\"> Coeficientes </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> -1 </td>\n   <td style=\"text-align:right;\"> -4 </td>\n   <td style=\"text-align:right;\"> 3.713489 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> -5 </td>\n   <td style=\"text-align:right;\"> 4.170132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> -3 </td>\n   <td style=\"text-align:right;\"> 6.044832 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> -2 </td>\n   <td style=\"text-align:right;\"> 7.186793 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Construção do dendrograma\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-17_e9e969b3f9eb816b026cd7e7f959fb67'}\n\n```{.r .cell-code}\n#dev.off()\nfviz_dend(x = cluster_hier)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mod1_01_01_analise_de_cluster_vestibular_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### Dendrograma com visualização dos clusters (definição de 3 clusters)\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-18_5a636224db733c47a106a9bc11ec23d5'}\n\n```{.r .cell-code}\nfviz_dend(x = cluster_hier,\n          k = 3,\n          k_colors = c(\"deeppink4\", \"darkviolet\", \"deeppink\"),\n          color_labels_by_k = F,\n          rect = T,\n          rect_fill = T,\n          lwd = 1,\n          ggtheme = theme_bw())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mod1_01_01_analise_de_cluster_vestibular_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n### Identificando os *clusters* no *dataset*\n\nCriando a variável categórica para indicação do cluster no banco de dados\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-19_9dfbb580edcefca8477b86d6c5d4152e'}\n\n```{.r .cell-code}\n# O argumento 'k' indica a quantidade de clusters\nVestibular$cluster_H <- factor(cutree(tree = cluster_hier, k = 3))\nVestibular\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 5\n  estudante   matematica fisica quimica cluster_H\n  <chr>            <dbl>  <dbl>   <dbl> <fct>    \n1 Gabriela          3.70   2.70    9.10 1        \n2 Luiz Felipe       7.80   8       1.5  2        \n3 Patricia          8.90   1       2.70 3        \n4 Ovidio            7      1       9    1        \n5 Leonor            3.40   2       5    1        \n```\n:::\n:::\n\n\nVisualização da base de dados com a alocação das observações nos *clusters*\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-20_3f7ee077c9c2d601fa2451dd0d881a5c'}\n\n```{.r .cell-code}\nVestibular %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\", \n                full_width = FALSE,\n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> estudante </th>\n   <th style=\"text-align:right;\"> matematica </th>\n   <th style=\"text-align:right;\"> fisica </th>\n   <th style=\"text-align:right;\"> quimica </th>\n   <th style=\"text-align:left;\"> cluster_H </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gabriela </td>\n   <td style=\"text-align:right;\"> 3.7 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n   <td style=\"text-align:right;\"> 9.1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luiz Felipe </td>\n   <td style=\"text-align:right;\"> 7.8 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Patricia </td>\n   <td style=\"text-align:right;\"> 8.9 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ovidio </td>\n   <td style=\"text-align:right;\"> 7.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 9.0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Leonor </td>\n   <td style=\"text-align:right;\"> 3.4 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Estatísticas descritivas dos *clusters* por variável\n\n> ATENÇÃO: *Clusters* 2 e 3 têm somente uma observação, não calcula `sd`\n\n-   Estatísticas descritivas da variável **matemática**\n\n\n    ::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-21_42b8f99f16cbe3cbbf4004cca749b57e'}\n    \n    ```{.r .cell-code}\n    group_by(Vestibular, cluster_H) %>%\n      summarise(\n        mean = mean(matematica, na.rm = TRUE),\n        sd = sd(matematica, na.rm = TRUE),\n        min = min(matematica, na.rm = TRUE),\n        max = max(matematica, na.rm = TRUE),\n        count = length(matematica))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 3 × 6\n      cluster_H  mean    sd   min   max count\n      <fct>     <dbl> <dbl> <dbl> <dbl> <int>\n    1 1          4.70  2.00  3.40  7        3\n    2 2          7.80 NA     7.80  7.80     1\n    3 3          8.90 NA     8.90  8.90     1\n    ```\n    :::\n    :::\n\n\n-   Estatísticas descritivas da variável 'fisica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-22_b0e6053769ae430aba0ca91bf0a893c5'}\n\n```{.r .cell-code}\ngroup_by(Vestibular, cluster_H) %>%\n  summarise(\n    mean = mean(fisica, na.rm = TRUE),\n    sd = sd(fisica, na.rm = TRUE),\n    min = min(fisica, na.rm = TRUE),\n    max = max(fisica, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  cluster_H  mean     sd   min   max\n  <fct>     <dbl>  <dbl> <dbl> <dbl>\n1 1          1.90  0.854     1  2.70\n2 2          8    NA         8  8   \n3 3          1    NA         1  1   \n```\n:::\n:::\n\n\n-   Estatísticas descritivas da variável **química**\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-23_a7515cd7d73840a9408d871c2c3427d1'}\n\n```{.r .cell-code}\ngroup_by(Vestibular, cluster_H) %>%\n  summarise(\n    mean = mean(quimica, na.rm = TRUE),\n    sd = sd(quimica, na.rm = TRUE),\n    min = min(quimica, na.rm = TRUE),\n    max = max(quimica, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  cluster_H  mean    sd   min   max\n  <fct>     <dbl> <dbl> <dbl> <dbl>\n1 1          7.70  2.34  5     9.10\n2 2          1.5  NA     1.5   1.5 \n3 3          2.70 NA     2.70  2.70\n```\n:::\n:::\n\n\n### Análise de variância de um fator (ANOVA).\n\nInterpretação do output:\n\n-   Mean Sq do cluster_H: indica a variabilidade entre grupos\n\n\n```{=html}\n<!-- -->\n```\n\n-   Mean Sq dos Residuals: indica a variabilidade dentro dos grupos\n\n\n```{=html}\n<!-- -->\n```\n\n-   F value: estatística de teste (Sum Sq do cluster_H / Sum Sq dos Residuals)\n\n-    Pr(\\>F): p-valor da estatística\n\n-   p-valor \\< 0.05: pelo menos um cluster apresenta média estatisticamente diferente dos demais\n\n-    A variável mais discriminante dos grupos contém maior estatística F (e significativa)\n\n#### ANOVA da variável 'matematica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-24_839683778b392ea41c0d33d40e14e994'}\n\n```{.r .cell-code}\nsummary(anova_matematica <- aov(formula = matematica ~ cluster_H,\ndata = Vestibular))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\ncluster_H    2  16.59   8.296   2.079  0.325\nResiduals    2   7.98   3.990               \n```\n:::\n:::\n\n\n#### ANOVA da variável 'fisica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-25_d55972d1c5d12db106ddaeadbe6521a0'}\n\n```{.r .cell-code}\nsummary(anova_fisica <- aov(formula = fisica ~ cluster_H,\ndata = Vestibular))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)  \ncluster_H    2  32.61   16.31   22.34 0.0429 *\nResiduals    2   1.46    0.73                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n#### ANOVA da variável 'quimica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-26_cd6bb85c3e0fc96d91b2f8649649c948'}\n\n```{.r .cell-code}\nsummary(anova_quimica <- aov(formula = quimica ~ cluster_H,\ndata = Vestibular))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\ncluster_H    2  38.35   19.18   3.506  0.222\nResiduals    2  10.94    5.47               \n```\n:::\n:::\n\n\n## Esquema de aglomeração não hierárquico K-MEANS\n\n### Elaboração da clusterização não hieráquica k-means\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-27_c0b803e7c3d921d9f9ec2c3dab5192c1'}\n\n```{.r .cell-code}\ncluster_kmeans <- kmeans(Vestibular[,2:4],\n                         centers = 3)\n```\n:::\n\n\n`centers`: parametrização da quantidade de *clusters*\n\n### Método de Elbow para identificação do número ótimo de clusters\n\nApresenta a variação total dentro dos clusters para várias nº de clusters.\n\nEm geral, quando há a dobra é um indício do número ótimo de clusters.\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-28_99b939eaf6a14ccfe34fb91e009205ce'}\n\n```{.r .cell-code}\nfviz_nbclust(Vestibular[,2:4], kmeans, method = \"wss\", k.max = 4)\n```\n\n::: {.cell-output-display}\n![](mod1_01_01_analise_de_cluster_vestibular_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n### Criando variável categórica para indicação do cluster no banco de dados\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-29_066677eb8fd61712b9141331152ce820'}\n\n```{.r .cell-code}\nVestibular$cluster_K <- factor(cluster_kmeans$cluster)\nVestibular\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 6\n  estudante   matematica fisica quimica cluster_H cluster_K\n  <chr>            <dbl>  <dbl>   <dbl> <fct>     <fct>    \n1 Gabriela          3.70   2.70    9.10 1         1        \n2 Luiz Felipe       7.80   8       1.5  2         2        \n3 Patricia          8.90   1       2.70 3         3        \n4 Ovidio            7      1       9    1         1        \n5 Leonor            3.40   2       5    1         1        \n```\n:::\n:::\n\n\n#### Visualização da base de dados\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-30_093da696d9cc2c656e23745a9f54e294'}\n\n```{.r .cell-code}\nVestibular %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\", \n                full_width = FALSE,\n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> estudante </th>\n   <th style=\"text-align:right;\"> matematica </th>\n   <th style=\"text-align:right;\"> fisica </th>\n   <th style=\"text-align:right;\"> quimica </th>\n   <th style=\"text-align:left;\"> cluster_H </th>\n   <th style=\"text-align:left;\"> cluster_K </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gabriela </td>\n   <td style=\"text-align:right;\"> 3.7 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n   <td style=\"text-align:right;\"> 9.1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luiz Felipe </td>\n   <td style=\"text-align:right;\"> 7.8 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Patricia </td>\n   <td style=\"text-align:right;\"> 8.9 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ovidio </td>\n   <td style=\"text-align:right;\"> 7.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 9.0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Leonor </td>\n   <td style=\"text-align:right;\"> 3.4 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Análise de variância de um fator (ANOVA)\n\n#### ANOVA da variável 'matematica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-31_772a1d0b57df5ffa5790f1dd64f25b30'}\n\n```{.r .cell-code}\nsummary(anova_matematica <- aov(formula = matematica ~ cluster_K,\n                                data = Vestibular))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\ncluster_K    2  16.59   8.296   2.079  0.325\nResiduals    2   7.98   3.990               \n```\n:::\n:::\n\n\n#### ANOVA da variável 'fisica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-32_22491db5b0c298ab85802ef7014cc9e7'}\n\n```{.r .cell-code}\nsummary(anova_fisica <- aov(formula = fisica ~ cluster_K,\n                            data = Vestibular))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)  \ncluster_K    2  32.61   16.31   22.34 0.0429 *\nResiduals    2   1.46    0.73                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n#### ANOVA da variável 'quimica'\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-33_8643c0c7ae1d61eedf0357d50c19f75e'}\n\n```{.r .cell-code}\nsummary(anova_quimica <- aov(formula = quimica ~ cluster_K,\n                             data = Vestibular))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\ncluster_K    2  38.35   19.18   3.506  0.222\nResiduals    2  10.94    5.47               \n```\n:::\n:::\n\n\n## Comparando os resultados dos esquemas hierárquico e não hierárquico\n\n\n::: {.cell hash='mod1_01_01_analise_de_cluster_vestibular_cache/html/unnamed-chunk-34_5974f0260af94030402383fd75dba0b2'}\n\n```{.r .cell-code}\nVestibular %>%\n  select(estudante, cluster_H, cluster_K) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\",\n                full_width = FALSE,\n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> estudante </th>\n   <th style=\"text-align:left;\"> cluster_H </th>\n   <th style=\"text-align:left;\"> cluster_K </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gabriela </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luiz Felipe </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Patricia </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ovidio </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Leonor </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nFIM!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/plotly-binding-4.10.0/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.5.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}