{
  "hash": "451679a32b3a639266f7cd7f6b203eb6",
  "result": {
    "markdown": "---\nauthor: \"Luiz Favaro\"\nformat: html\neditor: visual\n---\n\n\n# Exemplo Varejistas {.unnumbered}\n\n**Curso**: MBA DSA USP ESALQ\n\n**Aula:** Unsupervised Machine Learning - Clustering II\n\n**Prof.**: Wilson Tarantin Jr.\n\n**Fonte**: Fávero e Belfiore, MANUAL DE ANÁLISE DE DADOS, Capítulo 09\n\n**Objetivo**: clusterizar um dataset com 18 observações com 5 variáveis de uma rede varejista com 18 lojas, divididas em 3 regionais.\n\n## Preparação\n\n### Instalação e carregamento dos pacotes utilizados\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-1_53bc2ee289a95d6cb25af9ddd23593f5'}\n\n```{.r .cell-code}\npacotes <- c(\"plotly\", #plataforma gráfica\n             \"tidyverse\", #carregar outros pacotes do R\n             \"ggrepel\", #geoms de texto e rótulo para 'ggplot2' que ajudam a #evitar sobreposição de textos\n\n             \"knitr\", \"kableExtra\", #formatação de tabelas\n             \"reshape2\", #função 'melt'\n             \"misc3d\", #gráficos 3D\n             \"plot3D\", #gráficos 3D\n             \"cluster\", #função 'agnes' para elaboração de clusters hierárquicos\n             \"factoextra\", #função 'fviz_dend' para construção de dendrogramas\n             \"ade4\") #função 'ade4' para matriz de distâncias em var. binárias\n\nif(sum(as.numeric(!pacotes %in% installed.packages())) != 0){\n  instalador <- pacotes[!pacotes %in% installed.packages()]\n  for(i in 1:length(instalador)) {\n    install.packages(instalador, dependencies = T)\n    break()}\n  sapply(pacotes, require, character = T) \n} else {\n  sapply(pacotes, require, character = T) \n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: plotly\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'plotly'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: tidyverse\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in system(\"timedatectl\", intern = TRUE): running command 'timedatectl'\nhad status 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n✔ purrr   0.3.4      \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks plotly::filter(), stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nLoading required package: ggrepel\n\nLoading required package: knitr\n\nLoading required package: kableExtra\n\n\nAttaching package: 'kableExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\n\nLoading required package: reshape2\n\n\nAttaching package: 'reshape2'\n\n\nThe following object is masked from 'package:tidyr':\n\n    smiths\n\n\nLoading required package: misc3d\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: no DISPLAY variable so Tk is not available\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: plot3D\nLoading required package: cluster\nLoading required package: factoextra\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\nLoading required package: ade4\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n    plotly  tidyverse    ggrepel      knitr kableExtra   reshape2     misc3d \n      TRUE       TRUE       TRUE       TRUE       TRUE       TRUE       TRUE \n    plot3D    cluster factoextra       ade4 \n      TRUE       TRUE       TRUE       TRUE \n```\n:::\n:::\n\n\n### Carregamento da base de dados\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-2_8a0992f3436fa4c14a9834b84d70f5d0'}\n\n```{.r .cell-code}\nload(file = \"./data/mod1_01_04_regiona_varejista.RData\")\n```\n:::\n\n\n### Contexto\n\nNotas médias de cada uma das 18 lojas para os 3 atributos medidos\n\nAs lojas estão divididas em 3 regionais\n\n### Visualização da base de dados\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-3_543fb0aa32b528d8cad235c6cd2cd871'}\n\n```{.r .cell-code}\nRegionalVarejista %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\", \n                full_width = FALSE,\n                font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> loja </th>\n   <th style=\"text-align:left;\"> regional </th>\n   <th style=\"text-align:right;\"> atendimento </th>\n   <th style=\"text-align:right;\"> sortimento </th>\n   <th style=\"text-align:right;\"> organização </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 01 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 02 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 03 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 04 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 05 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 06 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 07 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 78 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 08 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 09 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 13 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 76 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 78 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 76 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 18 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Gráfico 3D com scatter\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-4_efedd56228e70d63887d8734e21da670'}\n\n```{.r .cell-code}\nrownames(RegionalVarejista) <- RegionalVarejista$loja\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Setting row names on a tibble is deprecated.\n```\n:::\n\n```{.r .cell-code}\nscatter3D(x=RegionalVarejista$atendimento,\n          y=RegionalVarejista$sortimento,\n          z=RegionalVarejista$organização,\n          phi = 0, bty = \"g\", pch = 20, cex = 2,\n          xlab = \"Atendimento\",\n          ylab = \"Sortimento\",\n          zlab = \"Organização\",\n          main = \"Lojas\",\n          clab = \"Notas Médias\")>\n  text3D(x=RegionalVarejista$atendimento,\n         y=RegionalVarejista$sortimento,\n         z=RegionalVarejista$organização,\n         labels = rownames(RegionalVarejista),\n         add = TRUE, cex = 1)\n```\n\n::: {.cell-output-display}\n![](mod1_01_04_analise_de_cluster_varejistas_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]  [,2]  [,3]  [,4]\n[1,] FALSE FALSE FALSE FALSE\n[2,] FALSE FALSE FALSE FALSE\n[3,] FALSE FALSE FALSE FALSE\n[4,] FALSE FALSE FALSE FALSE\n```\n:::\n:::\n\n\nNo estão as 18 lojas distribuiídas em 3 eixos: atendimento, organização e sortimento.\n\nConclusões a cerca das informações presentes no gráfico:\n\n-   É possível em ver que no canto inferior esquerdo há um grupo de lojas que naturalmente formam um *cluster*: organização, atendimento e sortimento ruins.\n\n-   Os pontos superiores em vermelhos (escuro e claro) parecem formar um segundo *cluster* e as outras lojas em azul e verde formal um terceiro *cluster.*\n\n### Estatísticas descritivas\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-5_f1716af1adcd97eeda2d5a809f5e7e39'}\n\n```{.r .cell-code}\nsummary(RegionalVarejista$atendimento)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.00    6.00   11.00   28.11   52.00   78.00 \n```\n:::\n:::\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-6_4ea744a7dcbb49407deed5cdfce77747'}\n\n```{.r .cell-code}\nsummary(RegionalVarejista$sortimento)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.00    4.00    6.00   27.89   51.50   86.00 \n```\n:::\n:::\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-7_51da3d8e9ceca7201c805dbdd2fe5849'}\n\n```{.r .cell-code}\nsummary(RegionalVarejista$organização)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.00    4.00    6.00   33.11   55.00  100.00 \n```\n:::\n:::\n\n\nÉ possível observar que para as 3 variáveis as medianas se diferenciam muito da média, provavelmente provocadas por aquelas lojas em azul no gráfico 3D que possuem valore muito baixos.\n\n### Padronização\n\nNeste caso, não faremos a padronização. As variáveis já estão na mesma escala\n\n## Esquema de aglomeração hierárquico\n\n### Matriz de dissimilaridades\n\nCria a matriz de distância usando o método **euclidiano**.\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-8_6ec5ac77c57099770c8f410e3587ac44'}\n\n```{.r .cell-code}\nmatriz_D <- RegionalVarejista %>% \n  select(atendimento, sortimento, organização) %>% \n  dist(method = \"euclidean\")\n```\n:::\n\n\n> `Method`: parametrização da distância a ser utilizada\n>\n> -   \"euclidean\": distância euclidiana\n>\n> -   \"euclidiana quadrática\": elevar ao quadrado matriz_D (matriz_D\\^2)\n>\n> -   \"maximum\": distância de Chebychev;\n>\n> -   \"manhattan\": distância de Manhattan (ou distância absoluta ou bloco);\n>\n> -   \"canberra\": distância de Canberra;\n>\n> -   \"minkowski\": distância de Minkowski\n\n### Visualizando a matriz de dissimilaridades\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-9_eb65e1f54b9f65c81c9f7113a8d15530'}\n\n```{.r .cell-code}\ndata.matrix(matriz_D) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\",\n  full_width = FALSE,\n  font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n   <th style=\"text-align:right;\"> 4 </th>\n   <th style=\"text-align:right;\"> 5 </th>\n   <th style=\"text-align:right;\"> 6 </th>\n   <th style=\"text-align:right;\"> 7 </th>\n   <th style=\"text-align:right;\"> 8 </th>\n   <th style=\"text-align:right;\"> 9 </th>\n   <th style=\"text-align:right;\"> 10 </th>\n   <th style=\"text-align:right;\"> 11 </th>\n   <th style=\"text-align:right;\"> 12 </th>\n   <th style=\"text-align:right;\"> 13 </th>\n   <th style=\"text-align:right;\"> 14 </th>\n   <th style=\"text-align:right;\"> 15 </th>\n   <th style=\"text-align:right;\"> 16 </th>\n   <th style=\"text-align:right;\"> 17 </th>\n   <th style=\"text-align:right;\"> 18 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 8.944272 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 106.13199 </td>\n   <td style=\"text-align:right;\"> 86.57944 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 98.50888 </td>\n   <td style=\"text-align:right;\"> 108.33282 </td>\n   <td style=\"text-align:right;\"> 121.95081 </td>\n   <td style=\"text-align:right;\"> 112.87161 </td>\n   <td style=\"text-align:right;\"> 100.59821 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 79.87490 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8.944272 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 6.633250 </td>\n   <td style=\"text-align:right;\"> 10.198039 </td>\n   <td style=\"text-align:right;\"> 9.165151 </td>\n   <td style=\"text-align:right;\"> 105.29957 </td>\n   <td style=\"text-align:right;\"> 87.22385 </td>\n   <td style=\"text-align:right;\"> 8.246211 </td>\n   <td style=\"text-align:right;\"> 10.392305 </td>\n   <td style=\"text-align:right;\"> 9.165151 </td>\n   <td style=\"text-align:right;\"> 96.04166 </td>\n   <td style=\"text-align:right;\"> 106.32027 </td>\n   <td style=\"text-align:right;\"> 119.43199 </td>\n   <td style=\"text-align:right;\"> 110.94143 </td>\n   <td style=\"text-align:right;\"> 99.95999 </td>\n   <td style=\"text-align:right;\"> 12.165525 </td>\n   <td style=\"text-align:right;\"> 78.25599 </td>\n   <td style=\"text-align:right;\"> 8.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 6.633250 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 104.36474 </td>\n   <td style=\"text-align:right;\"> 86.74099 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 96.43651 </td>\n   <td style=\"text-align:right;\"> 106.30146 </td>\n   <td style=\"text-align:right;\"> 120.34949 </td>\n   <td style=\"text-align:right;\"> 112.46333 </td>\n   <td style=\"text-align:right;\"> 100.02000 </td>\n   <td style=\"text-align:right;\"> 6.324555 </td>\n   <td style=\"text-align:right;\"> 78.99367 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 10.198039 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 107.36852 </td>\n   <td style=\"text-align:right;\"> 89.03932 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 100.03999 </td>\n   <td style=\"text-align:right;\"> 109.72693 </td>\n   <td style=\"text-align:right;\"> 124.00000 </td>\n   <td style=\"text-align:right;\"> 115.56816 </td>\n   <td style=\"text-align:right;\"> 102.95630 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 82.29216 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 9.165151 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 104.32641 </td>\n   <td style=\"text-align:right;\"> 85.81375 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 96.85040 </td>\n   <td style=\"text-align:right;\"> 106.60206 </td>\n   <td style=\"text-align:right;\"> 120.58192 </td>\n   <td style=\"text-align:right;\"> 112.28535 </td>\n   <td style=\"text-align:right;\"> 99.53894 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 78.84161 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 106.131993 </td>\n   <td style=\"text-align:right;\"> 105.299573 </td>\n   <td style=\"text-align:right;\"> 104.364745 </td>\n   <td style=\"text-align:right;\"> 107.368524 </td>\n   <td style=\"text-align:right;\"> 104.326411 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 73.81057 </td>\n   <td style=\"text-align:right;\"> 106.752049 </td>\n   <td style=\"text-align:right;\"> 105.584090 </td>\n   <td style=\"text-align:right;\"> 107.944430 </td>\n   <td style=\"text-align:right;\"> 22.09072 </td>\n   <td style=\"text-align:right;\"> 14.69694 </td>\n   <td style=\"text-align:right;\"> 45.51923 </td>\n   <td style=\"text-align:right;\"> 88.02272 </td>\n   <td style=\"text-align:right;\"> 58.85576 </td>\n   <td style=\"text-align:right;\"> 108.018517 </td>\n   <td style=\"text-align:right;\"> 58.61740 </td>\n   <td style=\"text-align:right;\"> 107.405773 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 86.579443 </td>\n   <td style=\"text-align:right;\"> 87.223850 </td>\n   <td style=\"text-align:right;\"> 86.740994 </td>\n   <td style=\"text-align:right;\"> 89.039317 </td>\n   <td style=\"text-align:right;\"> 85.813752 </td>\n   <td style=\"text-align:right;\"> 73.81057 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 88.249646 </td>\n   <td style=\"text-align:right;\"> 88.294960 </td>\n   <td style=\"text-align:right;\"> 87.384209 </td>\n   <td style=\"text-align:right;\"> 67.94115 </td>\n   <td style=\"text-align:right;\"> 75.36577 </td>\n   <td style=\"text-align:right;\"> 64.18723 </td>\n   <td style=\"text-align:right;\"> 38.83298 </td>\n   <td style=\"text-align:right;\"> 24.49490 </td>\n   <td style=\"text-align:right;\"> 89.866568 </td>\n   <td style=\"text-align:right;\"> 26.30589 </td>\n   <td style=\"text-align:right;\"> 89.933309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 8.246211 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 106.75205 </td>\n   <td style=\"text-align:right;\"> 88.24965 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 99.05554 </td>\n   <td style=\"text-align:right;\"> 108.86689 </td>\n   <td style=\"text-align:right;\"> 122.84950 </td>\n   <td style=\"text-align:right;\"> 114.29786 </td>\n   <td style=\"text-align:right;\"> 102.00000 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 81.14185 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 10.392305 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 105.58409 </td>\n   <td style=\"text-align:right;\"> 88.29496 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 98.40732 </td>\n   <td style=\"text-align:right;\"> 108.01852 </td>\n   <td style=\"text-align:right;\"> 122.65398 </td>\n   <td style=\"text-align:right;\"> 114.99565 </td>\n   <td style=\"text-align:right;\"> 101.92154 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 81.28961 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 9.165151 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 107.94443 </td>\n   <td style=\"text-align:right;\"> 87.38421 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 100.17984 </td>\n   <td style=\"text-align:right;\"> 110.07270 </td>\n   <td style=\"text-align:right;\"> 123.33694 </td>\n   <td style=\"text-align:right;\"> 113.49009 </td>\n   <td style=\"text-align:right;\"> 101.68579 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 80.94443 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 98.508883 </td>\n   <td style=\"text-align:right;\"> 96.041658 </td>\n   <td style=\"text-align:right;\"> 96.436508 </td>\n   <td style=\"text-align:right;\"> 100.039992 </td>\n   <td style=\"text-align:right;\"> 96.850400 </td>\n   <td style=\"text-align:right;\"> 22.09072 </td>\n   <td style=\"text-align:right;\"> 67.94115 </td>\n   <td style=\"text-align:right;\"> 99.055540 </td>\n   <td style=\"text-align:right;\"> 98.407317 </td>\n   <td style=\"text-align:right;\"> 100.179838 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 12.32883 </td>\n   <td style=\"text-align:right;\"> 35.66511 </td>\n   <td style=\"text-align:right;\"> 76.13147 </td>\n   <td style=\"text-align:right;\"> 52.15362 </td>\n   <td style=\"text-align:right;\"> 101.054441 </td>\n   <td style=\"text-align:right;\"> 46.69047 </td>\n   <td style=\"text-align:right;\"> 99.639350 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 108.332820 </td>\n   <td style=\"text-align:right;\"> 106.320271 </td>\n   <td style=\"text-align:right;\"> 106.301458 </td>\n   <td style=\"text-align:right;\"> 109.726934 </td>\n   <td style=\"text-align:right;\"> 106.602064 </td>\n   <td style=\"text-align:right;\"> 14.69694 </td>\n   <td style=\"text-align:right;\"> 75.36577 </td>\n   <td style=\"text-align:right;\"> 108.866891 </td>\n   <td style=\"text-align:right;\"> 108.018517 </td>\n   <td style=\"text-align:right;\"> 110.072703 </td>\n   <td style=\"text-align:right;\"> 12.32883 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 36.76955 </td>\n   <td style=\"text-align:right;\"> 83.54639 </td>\n   <td style=\"text-align:right;\"> 58.03447 </td>\n   <td style=\"text-align:right;\"> 110.616455 </td>\n   <td style=\"text-align:right;\"> 56.46238 </td>\n   <td style=\"text-align:right;\"> 109.434912 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 121.950810 </td>\n   <td style=\"text-align:right;\"> 119.431989 </td>\n   <td style=\"text-align:right;\"> 120.349491 </td>\n   <td style=\"text-align:right;\"> 124.000000 </td>\n   <td style=\"text-align:right;\"> 120.581922 </td>\n   <td style=\"text-align:right;\"> 45.51923 </td>\n   <td style=\"text-align:right;\"> 64.18723 </td>\n   <td style=\"text-align:right;\"> 122.849501 </td>\n   <td style=\"text-align:right;\"> 122.653985 </td>\n   <td style=\"text-align:right;\"> 123.336937 </td>\n   <td style=\"text-align:right;\"> 35.66511 </td>\n   <td style=\"text-align:right;\"> 36.76955 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 56.39149 </td>\n   <td style=\"text-align:right;\"> 40.49691 </td>\n   <td style=\"text-align:right;\"> 125.171882 </td>\n   <td style=\"text-align:right;\"> 48.53864 </td>\n   <td style=\"text-align:right;\"> 123.773988 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 112.871608 </td>\n   <td style=\"text-align:right;\"> 110.941426 </td>\n   <td style=\"text-align:right;\"> 112.463327 </td>\n   <td style=\"text-align:right;\"> 115.568162 </td>\n   <td style=\"text-align:right;\"> 112.285351 </td>\n   <td style=\"text-align:right;\"> 88.02272 </td>\n   <td style=\"text-align:right;\"> 38.83298 </td>\n   <td style=\"text-align:right;\"> 114.297856 </td>\n   <td style=\"text-align:right;\"> 114.995652 </td>\n   <td style=\"text-align:right;\"> 113.490088 </td>\n   <td style=\"text-align:right;\"> 76.13147 </td>\n   <td style=\"text-align:right;\"> 83.54639 </td>\n   <td style=\"text-align:right;\"> 56.39149 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 32.80244 </td>\n   <td style=\"text-align:right;\"> 116.858889 </td>\n   <td style=\"text-align:right;\"> 40.49691 </td>\n   <td style=\"text-align:right;\"> 115.741090 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100.598211 </td>\n   <td style=\"text-align:right;\"> 99.959992 </td>\n   <td style=\"text-align:right;\"> 100.019998 </td>\n   <td style=\"text-align:right;\"> 102.956301 </td>\n   <td style=\"text-align:right;\"> 99.538937 </td>\n   <td style=\"text-align:right;\"> 58.85576 </td>\n   <td style=\"text-align:right;\"> 24.49490 </td>\n   <td style=\"text-align:right;\"> 102.000000 </td>\n   <td style=\"text-align:right;\"> 101.921538 </td>\n   <td style=\"text-align:right;\"> 101.685791 </td>\n   <td style=\"text-align:right;\"> 52.15362 </td>\n   <td style=\"text-align:right;\"> 58.03447 </td>\n   <td style=\"text-align:right;\"> 40.49691 </td>\n   <td style=\"text-align:right;\"> 32.80244 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 103.942292 </td>\n   <td style=\"text-align:right;\"> 23.40940 </td>\n   <td style=\"text-align:right;\"> 103.421468 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 12.165525 </td>\n   <td style=\"text-align:right;\"> 6.324555 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 108.01852 </td>\n   <td style=\"text-align:right;\"> 89.86657 </td>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 4.898980 </td>\n   <td style=\"text-align:right;\"> 101.05444 </td>\n   <td style=\"text-align:right;\"> 110.61645 </td>\n   <td style=\"text-align:right;\"> 125.17188 </td>\n   <td style=\"text-align:right;\"> 116.85889 </td>\n   <td style=\"text-align:right;\"> 103.94229 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n   <td style=\"text-align:right;\"> 83.47455 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 79.874902 </td>\n   <td style=\"text-align:right;\"> 78.255990 </td>\n   <td style=\"text-align:right;\"> 78.993671 </td>\n   <td style=\"text-align:right;\"> 82.292162 </td>\n   <td style=\"text-align:right;\"> 78.841613 </td>\n   <td style=\"text-align:right;\"> 58.61740 </td>\n   <td style=\"text-align:right;\"> 26.30589 </td>\n   <td style=\"text-align:right;\"> 81.141851 </td>\n   <td style=\"text-align:right;\"> 81.289606 </td>\n   <td style=\"text-align:right;\"> 80.944425 </td>\n   <td style=\"text-align:right;\"> 46.69047 </td>\n   <td style=\"text-align:right;\"> 56.46238 </td>\n   <td style=\"text-align:right;\"> 48.53864 </td>\n   <td style=\"text-align:right;\"> 40.49691 </td>\n   <td style=\"text-align:right;\"> 23.40940 </td>\n   <td style=\"text-align:right;\"> 83.474547 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 82.437855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4.000000 </td>\n   <td style=\"text-align:right;\"> 8.000000 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 107.40577 </td>\n   <td style=\"text-align:right;\"> 89.93331 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 3.464102 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 99.63935 </td>\n   <td style=\"text-align:right;\"> 109.43491 </td>\n   <td style=\"text-align:right;\"> 123.77399 </td>\n   <td style=\"text-align:right;\"> 115.74109 </td>\n   <td style=\"text-align:right;\"> 103.42147 </td>\n   <td style=\"text-align:right;\"> 4.472136 </td>\n   <td style=\"text-align:right;\"> 82.43786 </td>\n   <td style=\"text-align:right;\"> 0.000000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Elaboração da clusterização hierárquica\n\nRealiza a clusterização hierárquica usando o método *single linkage* (vizinhos mais próximos).\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-10_e8f79e66e572aa98e82ecd8d51ab7870'}\n\n```{.r .cell-code}\ncluster_hier <- agnes(x = matriz_D, method = \"single\")\ncluster_hier\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\t agnes(x = matriz_D, method = \"single\") \nAgglomerative coefficient:  0.854752 \nOrder of objects:\n [1]  1 10  5  4 16  9  8 18  3  2  6 11 12 13  7 15 17 14\nHeight (summary):\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  2.000   2.000   6.633  16.801  24.495  78.256 \n\nAvailable components:\n[1] \"order\"  \"height\" \"ac\"     \"merge\"  \"diss\"   \"call\"   \"method\"\n```\n:::\n:::\n\n\n`Method` é o tipo de encadeamento:\n\n-   \"complete\": encadeamento completo (furthest neighbor ou complete linkage)\n\n-   \"single\": encadeamento único (nearest neighbor ou single linkage)\n\n-   \"average\": encadeamento médio (between groups ou average linkage)\n\n### Definição do esquema hierárquico de aglomeração\n\nAs distâncias (alturas para dendrograma) para as combinações em cada estágio.\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-11_84d024c7643400d55f0813d02c10ea49'}\n\n```{.r .cell-code}\ncoeficientes <- sort(cluster_hier$height, decreasing = FALSE)\ncoeficientes\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  2.000000  2.000000  2.000000  2.000000  2.000000  2.000000  2.000000\n [8]  2.828427  6.633250 12.328828 14.696938 23.409400 24.494897 32.802439\n[15] 35.665109 40.496913 78.255990\n```\n:::\n:::\n\n\n#### Tabela com o esquema de aglomeração.\n\n> Interpretação do output:\n>\n> As linhas são os estágios de aglomeração\n>\n> -   Nas colunas Cluster1 e Cluster2, observa-se como ocorreu a junção\n>\n> -   Quando for número negativo, indica observação isolada\n>\n> -   Quando for número positivo, indica cluster formado anteriormente (estágio)\n>\n> -   Coeficientes: as distâncias para as combinações em cada estágio\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-12_93fb8b88b859d65a4b277b0dd0ac4272'}\n\n```{.r .cell-code}\nesquema <- as.data.frame(cbind(cluster_hier$merge, coeficientes))\nnames(esquema) <- c(\"Cluster1\", \"Cluster2\", \"Coeficientes\")\n```\n:::\n\n\n#### Visualização do esquema hierárquico de aglomeração\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-13_5108e8adc20adaf94f364560aa64244b'}\n\n```{.r .cell-code}\nesquema %>%\n  kable(row.names = T) %>%\n  kable_styling(bootstrap_options = \"striped\",\n  full_width = FALSE,\n  font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Cluster1 </th>\n   <th style=\"text-align:right;\"> Cluster2 </th>\n   <th style=\"text-align:right;\"> Coeficientes </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> -8 </td>\n   <td style=\"text-align:right;\"> -18 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> -4 </td>\n   <td style=\"text-align:right;\"> -16 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> -9 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> -1 </td>\n   <td style=\"text-align:right;\"> -10 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> -5 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> -3 </td>\n   <td style=\"text-align:right;\"> 2.828427 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> -2 </td>\n   <td style=\"text-align:right;\"> 6.633250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:right;\"> -11 </td>\n   <td style=\"text-align:right;\"> -12 </td>\n   <td style=\"text-align:right;\"> 12.328828 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:right;\"> -6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14.696938 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> -15 </td>\n   <td style=\"text-align:right;\"> -17 </td>\n   <td style=\"text-align:right;\"> 23.409400 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 13 </td>\n   <td style=\"text-align:right;\"> -7 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 24.494897 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> -14 </td>\n   <td style=\"text-align:right;\"> 32.802439 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> -13 </td>\n   <td style=\"text-align:right;\"> 35.665109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 40.496913 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 78.255990 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Interpretação da tabela**\n\nVemos que várias observações se unem na altura 2. Provavelmente se referem àquelas\n\nNa primeira linha, que é o estágio 1de aglomeração, a observação 8 foi juntada à observação 18 na altura 2.\n\nNa segunda linha, que é o estágio 2 da aglomeração, a observação 4 foi juntada à observação 16 na altura 2.\n\nA primeira vez que uma nova observação é adicionada a um cluster é na teceira linha, que é o estágio 3 da aglomeração, em que *cluster* gerado no estágio 2 é unido recebe a observação 9, também na altura 2.\n\n### Dendrograma\n\n#### Construção do dendrograma\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-14_c7c0bfa1d5d2eaef317723136c448aa5'}\n\n```{.r .cell-code}\n#dev.off()\nfviz_dend(x = cluster_hier)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mod1_01_04_analise_de_cluster_varejistas_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n**Interpretação do gráfico**\n\n1.  Vemos de fato a formação de um *cluster* formado pelas ligações abaixo da altura 6,6, onde a observação 2 se liga ao *cluster*, confirmando o gráfico 3D do início.\n2.  Fazendo um corte na altura do 39, temos 3 *clusters*, um em que a observação 13 é a última a ser adicionada ao *cluster* e outro em que a observação 14 é a última a ser adicionada em outro *cluster*.\n3.  O *cluster* 2 acaba ficando com lojas um pouco distintas, pois a observação se junta à ele numa altura muito alta, o que representa que ela é bem diferente.\n4.  Se o corte fosse traçado 33, os *clusters* ficariam mais homogêneos, com as obervações 13 e 14 formando *clusters* de uma única observação.\n\n#### Dendrograma com visualização dos clusters\n\nDefinindo 3 clusters para comparar com regionais\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-15_6d7907594b170edff72ca5db6fe57824'}\n\n```{.r .cell-code}\nfviz_dend(x = cluster_hier,\n  k = 3,\n  k_colors = c(\"deeppink4\", \"darkviolet\", \"deeppink\"),\n  color_labels_by_k = F,\n  rect = T,\n  rect_fill = T,\n  lwd = 1,\n  ggtheme = theme_bw())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mod1_01_04_analise_de_cluster_varejistas_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### Criando variável categórica para indicação do cluster no banco de dados\n\nO argumento 'k' indica a quantidade de clusters\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-16_3d20fa14683d2f036feaebb07e695f22'}\n\n```{.r .cell-code}\nRegionalVarejista$cluster_H <- factor(cutree(tree = cluster_hier, k = 3))\n```\n:::\n\n\n### Visualização da base de dados com a alocação das observações nos clusters\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-17_ef5ec004b58f806ffc242b5add2713af'}\n\n```{.r .cell-code}\nRegionalVarejista %>%\n  select(regional, cluster_H) %>%\n  arrange(regional) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\",\n  full_width = FALSE,\n  font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> regional </th>\n   <th style=\"text-align:left;\"> cluster_H </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Conclusão:** as lojas das mesmas regionais caíram nos mesmos *clusters.*\n\n### Estatísticas descritivas dos clusters por variável\n\nEstudando mais profundamente as variáveis por *cluster.*\n\n#### Variável 'atendimento'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-18_1a1ec4be9c24b42f6b891ab34a643b50'}\n\n```{.r .cell-code}\ngroup_by(RegionalVarejista, cluster_H) %>%\n  summarise(\n  mean = mean(atendimento, na.rm = TRUE),\n  sd = sd(atendimento, na.rm = TRUE),\n  min = min(atendimento, na.rm = TRUE),\n  max = max(atendimento, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  cluster_H  mean    sd   min   max\n  <fct>     <dbl> <dbl> <dbl> <dbl>\n1 1           6.2  3.19     2    14\n2 2          55   15.7     38    76\n3 3          56   15.9     40    78\n```\n:::\n:::\n\n\n#### Variável 'sortimento'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-19_37b6c18a638ba231806b20b52e0a488d'}\n\n```{.r .cell-code}\ngroup_by(RegionalVarejista, cluster_H) %>%\n  summarise(\n  mean = mean(sortimento, na.rm = TRUE),\n  sd = sd(sortimento, na.rm = TRUE),\n  min = min(sortimento, na.rm = TRUE),\n  max = max(sortimento, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  cluster_H  mean    sd   min   max\n  <fct>     <dbl> <dbl> <dbl> <dbl>\n1 1           4.2  1.48     2     6\n2 2          41   12.9     32    60\n3 3          74   12.8     56    86\n```\n:::\n:::\n\n\n#### Variável 'organização'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-20_12502dc88e834a92b017c71fb9360793'}\n\n```{.r .cell-code}\ngroup_by(RegionalVarejista, cluster_H) %>%\n  summarise(\n  mean = mean(organização, na.rm = TRUE),\n  sd = sd(organização, na.rm = TRUE),\n  min = min(organização, na.rm = TRUE),\n  max = max(organização, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  cluster_H  mean    sd   min   max\n  <fct>     <dbl> <dbl> <dbl> <dbl>\n1 1           4.4  1.26     2     6\n2 2          93    7.02    86   100\n3 3          45    9.45    38    58\n```\n:::\n:::\n\n\n**Análise das variáveis:**\n\n1.  As lojas do *cluster* 1 possuem as menores médias nas 3 variáveis. São as lojas azuis no gráfico 3D do início deste documento.\n2.  As lojas do *cluster* 2 possuem notas médias no atendimento e no sortimento, mas se destacam na organização, enquanto as lojas do *cluster* 3 tem notas médias em atendimento e organização, mas se destacam no sortimento.\n3.  Conclui-se que para melhoria da rede, as lojas do *cluster* 1 precisam melhorar nos 3 quesitos, enquanto que as lojas do *cluster* 2 precisam melhorar no atendimento e no sortimento e o *cluster* 3 precisa melhorar em atendimento e organização.\n\n### Análise de variância de um fator (ANOVA)\n\n**Objetivo:** verificar quais variáveis são importantes para a formação de pelo menos um *cluster.*\n\nBasicamente trata-se verificar se o p-valor da tabela (na coluna Pr(\\>F)) é menor que 0,05 para que uma variável seja estatisticamente significante para formar um *cluster*.\n\n> **Interpretação do *output* das ANOVAs das tabelas a seguir:**\n>\n> **Passo1:** a linha **Mean Sq do cluster_H** indica a variabilidade entre grupos. Trata-se da soma dos quadrados.\n>\n> **Passo2:** a linha **Mean Sq dos Residuals** indica a variabilidade dentro dos grupos. Também é soma dos quadrados dos resíduos\n>\n> **Passo3:** o **F value** é estatística de teste, oriunda da razão entre as médias ($\\dfrac{\\text{Sum Sq do cluster\\_H}}{\\text{Sum Sq dos Residuals}$)\n>\n> **Passo 4: Pr(\\>F**): p-valor da estatística F do passo 3\n>\n> -   Se **p-valor \\< 0.05**: pelo menos um *cluster* apresenta média estatisticamente diferente dos demais\n>\n> **Passo 5:** A variável mais discriminante dos grupos contém maior estatística F (e significativa)\n\n#### ANOVA da variável 'atendimento'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-21_95c7392e3fe2ef5511961e510689561b'}\n\n```{.r .cell-code}\nsummary(anova_atendimento <- aov(formula = atendimento ~ cluster_H,\ndata = RegionalVarejista))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncluster_H    2  10804    5402   50.91 2.06e-07 ***\nResiduals   15   1592     106                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nP-valor= 2.06e-07, portanto menor que 0,05, o que significa que a variável **atendimento** é estatisticamente relevante para formar ao menos 1 *cluster*.\n\n#### ANOVA da variável 'sortimento'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-22_ad1a554af162e1e8c2bf53c94f7013fb'}\n\n```{.r .cell-code}\nsummary(anova_sortimento <- aov(formula = sortimento ~ cluster_H,\ndata = RegionalVarejista))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncluster_H    2  14804    7402   110.2 1.08e-09 ***\nResiduals   15   1008      67                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nP-valor= 1.08e-09, portanto menor que 0,05, o que significa que a variável **sortimento** é estatisticamente relevante para formar ao menos 1 *cluster*.\n\n#### ANOVA da variável 'organização'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-23_3afa38480cd3b9bbbfd33035bd636204'}\n\n```{.r .cell-code}\nsummary(anova_organiza <- aov(formula = organização ~ cluster_H,\ndata = RegionalVarejista))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)    \ncluster_H    2  23155   11578   403.5 9.1e-14 ***\nResiduals   15    430      29                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nP-valor= 9.1e-14, portanto menor que 0,05, o que significa que a variável **organização** é estatisticamente relevante para formar ao menos 1 *cluster*.\n\n------------------------------------------------------------------------\n\nEm ordem de importância, a variável **orgnanização** é a que mais auxiliou na formação dos *clusters*, com uma estatística F de 403,5, seguida pela variável **sortimento** com uma estatística F de 110,2 e por fim a variável **atendimento**, com uma estatística F de 50,91.\n\n### Análise de Robustez\n\nVamos realizar uma análise de robustez do resultado anterior.\n\nVamos alterar a medida de distância de **euclidiana** para ***Manhattan*** e o método de encadeamento de ***single linkage*** para ***complete linkage***.\n\n#### Elaboração da matriz de distâncias com a distância de 'Manhattan'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-24_4e9039457e7f7fae8ef3076ca68de677'}\n\n```{.r .cell-code}\nmatriz_DM <- RegionalVarejista %>%\n  select(atendimento, sortimento, organização) %>%\n  dist(method = \"manhattan\")\n```\n:::\n\n\n#### Clusterização hierárquica com método 'complete'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-25_02fce0d5e9574ebc4ddb0575224fb87e'}\n\n```{.r .cell-code}\ncluster_hier_man <- agnes(x = matriz_DM, method = \"complete\")\ncluster_hier_man\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\t agnes(x = matriz_DM, method = \"complete\") \nAgglomerative coefficient:  0.9086189 \nOrder of objects:\n [1]  1 10  3  5  9  4 16  8 18  2  6 11 12 13  7 15 17 14\nHeight (summary):\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.00    4.00   14.00   39.88   42.00  214.00 \n\nAvailable components:\n[1] \"order\"  \"height\" \"ac\"     \"merge\"  \"diss\"   \"call\"   \"method\"\n```\n:::\n:::\n\n\n#### Construção do dendrograma\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-26_5ed17cc044993626e81df42e10054e3b'}\n\n```{.r .cell-code}\n#dev.off()\nfviz_dend(x = cluster_hier_man)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mod1_01_04_analise_de_cluster_varejistas_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nDe fato, o resultado também aponta para 3 clusters\n\n### Definindo 3 clusters para comparar com regionais\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-27_3293ca94852d650473d3bf1d0ed4a88a'}\n\n```{.r .cell-code}\nfviz_dend(x = cluster_hier_man,\n  k = 3,\n  k_colors = c(\"deeppink4\", \"darkviolet\", \"deeppink\"),\n  color_labels_by_k = F,\n  rect = T,\n  rect_fill = T,\n  lwd = 1,\n  ggtheme = theme_bw())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mod1_01_04_analise_de_cluster_varejistas_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n### Adicionando a variável ao banco de dados\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-28_31af5cad6e25b4029a68b02c4b05b605'}\n\n```{.r .cell-code}\nRegionalVarejista$cluster_H_man <- factor(cutree(tree = cluster_hier_man, k = 3))\n```\n:::\n\n\nPara este caso, gera exatamente o mesmo resultado, o que significa que é uma clusterização robusta, isto é, que não se altera de acordo com o tipo de distância e o método de *linkage* escolhidos.\n\n## Esquema de aglomeração não hierárquico K-MEANS\n\nO KMeans minimiza a soma dos quadrados internos de cada *cluster*.\n\n### Elaboração da clusterização não hieráquica k-means\n\nRealizando a clusterização usando o número de *clusters* definidos na clusterização hierárquia como parâmetro de entrada no KMeans.\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-29_86843173ad4c63019e0eedd972eeef3b'}\n\n```{.r .cell-code}\ncluster_kmeans <- kmeans(RegionalVarejista[,3:5], centers = 3)\ncluster_kmeans\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nK-means clustering with 3 clusters of sizes 1, 8, 9\n\nCluster means:\n  atendimento sortimento organização\n1   14.000000   2.000000    4.000000\n2   55.500000  57.500000   69.000000\n3    5.333333   4.444444    4.444444\n\nClustering vector:\n [1] 3 1 3 3 3 2 2 3 3 3 2 2 2 2 2 3 2 3\n\nWithin cluster sum of squares by cluster:\n[1]    0.00000 9692.00000   52.44444\n (between_SS / total_SS =  81.2 %)\n\nAvailable components:\n\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"      \n```\n:::\n:::\n\n\n### Criando variável categórica para indicação do cluster no banco de dados\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-30_0276c190efa0e58546487b32101131c4'}\n\n```{.r .cell-code}\nRegionalVarejista$cluster_K <- factor(cluster_kmeans$cluster)\nRegionalVarejista$cluster_K \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 3 1 3 3 3 2 2 3 3 3 2 2 2 2 2 3 2 3\nLevels: 1 2 3\n```\n:::\n:::\n\n\n### Método de Elbow para identificação do número ótimo de clusters\n\nChecando quantos grupos o método *Elbow* recomenda.\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-31_ced97fdaba77c9e32db7545ad7571446'}\n\n```{.r .cell-code}\nfviz_nbclust(RegionalVarejista[,3:5], kmeans, method = \"wss\", k.max = 10)\n```\n\n::: {.cell-output-display}\n![](mod1_01_04_analise_de_cluster_varejistas_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\nÉ possível observar que há uma susbtancial queda na soma dos quadrados internos das observações até a quantidade de *clusters* ser 3, a partir disso o aumento na quantidade *clusters* não altera muito.\n\n### Visualização da base de dados\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-32_74f30fac5300bab4bb2f5f3bb28ba1f2'}\n\n```{.r .cell-code}\nRegionalVarejista %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\",\n  full_width = FALSE,\n  font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> loja </th>\n   <th style=\"text-align:left;\"> regional </th>\n   <th style=\"text-align:right;\"> atendimento </th>\n   <th style=\"text-align:right;\"> sortimento </th>\n   <th style=\"text-align:right;\"> organização </th>\n   <th style=\"text-align:left;\"> cluster_H </th>\n   <th style=\"text-align:left;\"> cluster_H_man </th>\n   <th style=\"text-align:left;\"> cluster_K </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 01 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 02 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 03 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 04 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 05 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 06 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 07 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 78 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 08 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 09 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 98 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 13 </td>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:right;\"> 76 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 88 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 78 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 76 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 18 </td>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nObserva-se que os membros dos clusters pela clusterização hierárquica são os mesmo que os dos clusters definidos por KMeans, que por sua vez são os mesmos determinados pelas regionais.\n\n### Análise de variância de um fator (ANOVA)\n\nUtilizando ANOVA para verificar quais variáveis foram relevantes para a formação de pelo menos 1 *cluster*.\n\n#### ANOVA da variável 'atendimento'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-33_ffb39a6f0c79f529df1753ac7cb9fa6a'}\n\n```{.r .cell-code}\nsummary(anova_atendimento <- aov(\n  formula = atendimento ~ cluster_K,\n  data = RegionalVarejista))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)    \ncluster_K    2  10870    5435   53.42 1.5e-07 ***\nResiduals   15   1526     102                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n#### ANOVA da variável 'sortimento'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-34_6c1fe18a3c73681d3697440b550aaaa6'}\n\n```{.r .cell-code}\nsummary(anova_sortimento <- aov(formula = sortimento ~ cluster_K,\n  data = RegionalVarejista))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncluster_K    2  12632    6316   29.79 5.97e-06 ***\nResiduals   15   3180     212                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n#### ANOVA da variável 'organização'\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-35_a7fd6bd4af8b48d9b62678466e48e442'}\n\n```{.r .cell-code}\nsummary(anova_organiza <- aov(formula = organização ~ cluster_K,\n  data = RegionalVarejista))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncluster_K    2  18548    9274   27.61 9.38e-06 ***\nResiduals   15   5038     336                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n**Conclusão:** como na clusterização hierárquica, as 3 variáveis são relevantes para a formação de ao menos um *cluster* (todas com Pr(\\>F) menor que 0,05), sendo a mais relevante é a **organização** (com maior F value - 403,5) e a variável **atendimento** (com menor F value - 50,91) é a menos relevante.\n\n## Comparando os resultados dos esquemas hierárquico e não hierárquico\n\n\n::: {.cell hash='mod1_01_04_analise_de_cluster_varejistas_cache/html/unnamed-chunk-36_7acf36f4c1aaa8b07aff686631fd285e'}\n\n```{.r .cell-code}\nRegionalVarejista %>%\n  select(regional, cluster_H, cluster_K) %>%\n  arrange(regional) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = \"striped\",\n  full_width = FALSE,\n  font_size = 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> regional </th>\n   <th style=\"text-align:left;\"> cluster_H </th>\n   <th style=\"text-align:left;\"> cluster_K </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Regional 3 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nFIM!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}